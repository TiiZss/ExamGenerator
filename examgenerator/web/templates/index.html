{% extends "base.html" %}

{% block content %}
<div class="card" style="text-align: center;">
    <h2>Â¡Bienvenido a ExamGenerator!</h2>
    <p>Sistema completo para generaciÃ³n de exÃ¡menes aleatorios con soporte de inteligencia artificial.</p>
    <div
        style="margin-top: 10px; font-weight: bold; color: #667eea; background: #f0f4ff; display: inline-block; padding: 5px 15px; border-radius: 20px;">
        ğŸš€ Total ExÃ¡menes Generados: {{ total_exams }}
    </div>
</div>

<div class="grid">
    <div class="card feature">
        <div class="feature-icon">ğŸ“‹</div>
        <h3>Generar ExÃ¡menes</h3>
        <p>Crea exÃ¡menes aleatorios desde un archivo de preguntas existente.</p>
        <br>
        <a href="{{ url_for('generate_exams') }}" class="btn">Comenzar</a>
    </div>

    <div class="card feature">
        <div class="feature-icon">ğŸ¤–</div>
        <h3>IA - Generar Preguntas</h3>
        <p>Genera preguntas automÃ¡ticamente desde PDFs, DOCX o PPTX usando IA.</p>
        <br>
        <a href="{{ url_for('generate_questions') }}" class="btn">Comenzar</a>
    </div>
</div>

<!-- New Grid for Features and Cache Stats (Side by Side) -->
<div class="grid" style="margin-top: 20px;">
    <!-- Features Column -->
    <div class="card" style="margin-bottom: 0;">
        <h2>âœ¨ CaracterÃ­sticas</h2>
        <ul style="list-style: none; padding-left: 0; line-height: 1.2;"> <!-- Reduced line-height -->
            <li style="padding: 2px 0;">âœ… GeneraciÃ³n determinÃ­stica</li>
            <li style="padding: 2px 0;">âœ… ExportaciÃ³n: TXT, DOCX, PDF, Excel</li>
            <li style="padding: 2px 0;">âœ… Plantillas DOCX personalizadas</li>
            <li style="padding: 2px 0;">âœ… IA dual: Gemini + Ollama local</li>
            <li style="padding: 2px 0;">âœ… CachÃ© inteligente</li>
            <li style="padding: 2px 0;">âœ… EstadÃ­sticas y anÃ¡lisis</li>
            <li style="padding: 2px 0;">âœ… Web + CLI</li>
        </ul>
    </div>

    <!-- Cache Stats Column -->
    <div class="card" style="margin-bottom: 0; text-align: center;">
        <h2>ğŸ“Š EstadÃ­sticas del CachÃ©</h2>
        <div id="cache-stats">
            <p>Cargando...</p>
        </div>
        <br>
        <form method="POST" action="{{ url_for('clear_cache') }}" style="margin: 0;"
            onsubmit="return confirm('Â¿EstÃ¡s seguro?');">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
            <input type="hidden" name="older_than_days" value="0">
            <button type="submit" onclick="return confirm('Â¿Limpiar todo el cachÃ©?')">
                ğŸ—‘ï¸ Limpiar CachÃ©
            </button>
        </form>
    </div>
</div>

<script>
    // Cargar estadÃ­sticas del cachÃ©
    fetch('/cache/stats')
        .then(response => response.json())
        .then(data => {
            document.getElementById('cache-stats').innerHTML = `
                <p style="margin-bottom: 5px;"><strong>Entradas en cachÃ©:</strong> ${data.total_entries}</p>
                <p style="margin-bottom: 5px;"><strong>TamaÃ±o total:</strong> ${data.total_size_mb.toFixed(2)} MB</p>
                <p style="margin-bottom: 5px; font-size: 0.9em; color: #666; word-break: break-all;"><strong>Dir:</strong> ${data.cache_dir}</p>
            `;
        })
        .catch(error => {
            document.getElementById('cache-stats').innerHTML = '<p>Error cargando estadÃ­sticas</p>';
        });
</script>
{% endblock %}